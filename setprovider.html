<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Datenlieferant</title>
	<link rel="stylesheet" href="./assets/css/styles.css">
	<link rel="stylesheet" href="./assets/css/dark-styles.css">
	<link rel="stylesheet" href="./assets/css/line-colors.css">
	<link rel="shortcut icon" type="image/x-icon" href="./assets/branding/favicon.ico">
	<link rel="manifest" href="/manifest.json" type="application/json" >
	<meta name="theme-color" content="#000">
</head>

<body class="bodyWithPopup coloredbody fixednavbar">

<center>

<nav id="navbar"><div class="tabs"><span class="active">&nbsp;Datenlieferant&nbsp;</span></div><div class="iconbar bigonly"><a href="#" onclick="history.go(-1)">Schließen</a></div><div class="iconbar"><a href="#" onclick="history.go(-1)"><img src="./assets/icons/close.svg" class="mediumicon"></a></div></nav>

<br>

	
<div class="textonly">

	<h3>Aktuell gewählt</h3>
	<div class="listcontainer" id="providerselect">

	</div>

	<br>
	<h3>Verfügbar</h3>
	<div class="listcontainer" id="providerList">
	</div>
	
</center>

<script>


// Get the Region
document.addEventListener("DOMContentLoaded", () => {
	const providerKey = "provider";
	let provider = localStorage.getItem(providerKey);

	if (!provider) {
		provider = {
			providerName: "Deutsche Bahn",
			providerID: "de"
		};
		
		localStorage.setItem(providerKey, JSON.stringify(provider));
	} else {
		provider = JSON.parse(provider);
	}

	const span = document.getElementById("providerselect");
	span.innerHTML = `
		<div class="listitem"><div class="listimagecontainer"><img src="./assets/providerLogos/${provider.providerID}.svg" class="providericon noinvert"> </div><div class="listitemtext">${provider.providerName}<br><small class="disabled">Aktuell ausgewählt</small></div></div>
	`;
});


  // Region switch

	document.addEventListener("DOMContentLoaded", () => {
	const providerKey = "provider";

	const providers = [
		{ providerName: "Deutsche Bahn (DB)", providerID: "de", region: "Germany" },
		{ providerName: "Flixbus", providerID: "flixbus", region: "Europe" },
		{ providerName: "Nationale Maatschappij der Belgische Spoorwegen (NMBS)", providerID: "be", region: "Belgium" },
		{ providerName: "Nederlandse Spoorwegen (NS)", providerID: "nl", region: "Netherlands" },
		{ providerName: "Schweizerische Bundesbahnen (SBB)", providerID: "ch", region: "Switzerland" },
		{ providerName: "Société nationale des chemins de fer français (SNCF)", providerID: "fr", region: "France" },
		{ providerName: "Statens Järnvägar (SJ)", providerID: "se", region: "Sweden" },
		{ providerName: "VR-Yhtymä (VR)", providerID: "fi", region: "Finland" },
		{ providerName: "Vygruppen (VY)", providerID: "no", region: "Norway" },
	];

	let currentProvider = localStorage.getItem(providerKey);
	if (!currentProvider) {
		currentProvider = { providerName: "Deutsche Bahn", providerID: "de" };
		localStorage.setItem(providerKey, JSON.stringify(currentProvider));
	} else {
 		currentProvider = JSON.parse(currentProvider);
	}

	const container = document.getElementById("providerList");

	providers.forEach(p => {
		let indicatorHTML = "";

		if (p.providerID === currentProvider.providerID) {
			indicatorHTML = `
				<div class="listimagecontainer"><img src="./assets/icons/check.svg" class="noinvert"></div>
			`;
		}

		container.innerHTML += `
			<div class="listitem  provider cursorpointer"  data-id="${p.providerID}" data-name="${p.providerName}">
				<div class="listimagecontainer">
					<img src="./assets/providerLogos/${p.providerID}.svg" class="providericon noinvert"> 
				</div>
				<div class="listitemtext">
					${p.providerName}<br><small class="disabled">${p.region}</small>
				</div>
				${indicatorHTML}
			</div>
		`;
	});

	document.querySelectorAll(".provider").forEach(div => {
		div.addEventListener("click", () => {
			const newProvider = {
				providerName: div.getAttribute("data-name"),
				providerID: div.getAttribute("data-id")
			};
			localStorage.setItem(providerKey, JSON.stringify(newProvider));
			location.reload();
			});
		});
	});

</script>

</body>
</html>